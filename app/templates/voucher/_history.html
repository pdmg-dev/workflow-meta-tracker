<div class="voucher-history-timeline p-3">
  <div class="timeline">
    {% for h in voucher.history|sort(attribute="updated_at") %}
      <div class="timeline-item">
        <div class="timeline-date text-muted small">{{ h.updated_at|local_time }}</div>
        <div class="timeline-marker"></div>

        <div class="timeline-content">
          <div class="fw-bold">{{ h.status.name }}</div>
          {% if h.remarks %}
            <div class="text-secondary small mt-1">{{ h.remarks }}</div>
          {% endif %}
          <div class="small text-muted mt-1">Updated by: {{ h.updated_by_user.full_name }}</div>
        </div>
      </div>
    {% else %}
      <div class="text-muted">No status history yet.</div>
    {% endfor %}
  </div>
</div>

{% block style %}
  <style>
    .timeline {
      position: relative;
      display: flex;
      flex-direction: column;
    }
    .timeline-item {
      display: grid;
      grid-template-columns: 150px 20px 1fr; /* date | marker | content */
      align-items: start;
      column-gap: 1rem;
    }

    /* Left column (date) */
    .timeline-date {
      text-align: right;
      padding-top: 0.15rem;
    }

    /* Center marker with vertical line */
    .timeline-marker {
      position: relative;
      width: 14px;
      height: 14px;
      margin: 0 auto;
      background: #0d6efd; /* primary circle */
      border: 2px solid #fff;
      border-radius: 50%;
    }
    .timeline-marker::before {
      content: "";
      position: absolute;
      top: 14px;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: calc(100% + 4rem); /* continue line downward */
      background: #dee2e6;
    }

    /* Right column (status details) */
    .timeline-content {
      padding-top: 0.1rem;
    }
  </style>
{% endblock %}
